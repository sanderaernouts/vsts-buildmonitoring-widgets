define(["TFS/Build/Contracts","TFS/Build/RestClient","VSS/Controls","VSS/Controls/Grids"],function(t,e,n,i){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){var i,o;i=[n,e,n(6)],void 0!==(o=function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.disableTelemetry="false",this.disableAjaxTracking="false",this.enableDebug="false"}return t}();e.TelemetryClientSettings=i;var o=function(){function t(){this.IsAvailable=!0}return t.getClient=function(e){return this._instance||(console.log("Creating new TelemetryClient!"),this._instance=new t,this._instance.Init(e)),this._instance},t.prototype.Init=function(t){console.log("TelemetryClient settings disableTelemetry: "+("true"===t.disableTelemetry));var e={instrumentationKey:t.key,disableTelemetry:"true"===t.disableTelemetry,disableAjaxTracking:"true"===t.disableAjaxTracking,enableDebug:"true"===t.enableDebug};this.ExtensionContext=t.extensioncontext;try{var i=VSS.getWebContext();n.AppInsights.downloadAndSetup(e),n.AppInsights.setAuthenticatedUserContext(i.user.id,i.collection.id)}catch(t){console.log(t)}},t.prototype.trackPageView=function(t,e,i,o,r){try{n.AppInsights.trackPageView(this.ExtensionContext+"."+t,e,i,o,r),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackEvent=function(t,e,i){try{console.log("Tracking event: "+this.ExtensionContext+"."+t),n.AppInsights.trackEvent(this.ExtensionContext+"."+t,e,i),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackException=function(t,e,i,o){try{console.error(t);var r={name:this.ExtensionContext+"."+e,message:t};n.AppInsights.trackException(r,e,i,o),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackMetric=function(t,e,i,o,r,s){try{n.AppInsights.trackMetric(this.ExtensionContext+"."+t,e,i,o,r,s),n.AppInsights.flush()}catch(t){console.log(t)}},t}();e.TelemetryClient=o}.apply(e,i))&&(t.exports=o)},function(t,e,n){var i,o;i=[n,e],void 0!==(o=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.settings={key:"__InstrumentationKey__",extensioncontext:"build monitoring",disableTelemetry:"false",disableAjaxTracking:"false",enableDebug:"false"}}.apply(e,i))&&(t.exports=o)},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=i},function(t,e,n){"use strict";var i,o,r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){!function(t){var e=function(){function t(){}return t}();t.Base=e}(t.Telemetry||(t.Telemetry={}))}(r||(r={}));var r;!function(t){!function(t){var e=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();t.Envelope=e}(t.Telemetry||(t.Telemetry={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var s;!function(t){!function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"}(t.SeverityLevel||(t.SeverityLevel={}))}(s||(s={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={})),i=[n,e],void 0!==(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t._createLazyMethod=function(e){var n=window[t.appInsightsName];n[e]=function(){var t=arguments;n.queue?n.queue.push(function(){return n[e].apply(n,t)}):n[e].apply(n,t)}},t._defineLazyMethods=function(){var e=window[t.appInsightsName];try{e.cookie=document.cookie}catch(t){}e.queue=[];for(var n=["clearAuthenticatedUserContext","flush","setAuthenticatedUserContext","startTrackEvent","startTrackPage","stopTrackEvent","stopTrackPage","trackDependency","trackEvent","trackException","trackMetric","trackPageView","trackTrace"];n.length;)t._createLazyMethod(n.pop())},t._download=function(e){t.appInsightsInstance.config=e;var n=window[t.appInsightsName];if(n.queue||(n.queue=[]),setTimeout(function(){var t=document.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",document.head.appendChild(t)}),!e.disableExceptionTracking){t._createLazyMethod("_onerror");var i=window.onerror;window.onerror=function(t,e,o,r,s){var a=i&&i(t,e,o,r,s);return!0!==a&&n._onerror(t,e,o,r,s),a}}},Object.defineProperty(t,"appInsightsInstance",{get:function(){if("undefined"!=typeof window)return window[t.appInsightsName]||(window[t.appInsightsName]={downloadAndSetup:t._download,_defineLazyMethods:t._defineLazyMethods},t._defineLazyMethods()),window[t.appInsightsName]},enumerable:!0,configurable:!0}),t.appInsightsInitialized=!1,t.appInsightsName="appInsights",t}();e.AppInsights=n.appInsightsInstance}.apply(e,i))&&(t.exports=o)},,function(t,e,n){var i,o;i=[n,e,n(0),n(1),n(3),n(2),n(4),n(5)],void 0!==(o=function(t,e,n,i,o,r,s,a){"use strict";function c(t){var e=new l;switch(e.QueueTime=t.queueTime,e.Definition=t.definition.name,e.BuildNumber=t.buildNumber,t.result){case r.BuildResult.Succeeded:e.Result="succeeded";break;case r.BuildResult.PartiallySucceeded:e.Result="partially succeeded";break;case r.BuildResult.Failed:e.Result="failed";break;case r.BuildResult.Canceled:e.Result="canceled";break;case r.BuildResult.None:e.Result="none";break;default:e.Result="unkown"}return e}function u(t,e){var n=VSS.getWebContext().project.id;$("#query-info-container").empty(),o.getClient().getBuilds(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r.BuildStatus.Completed,r.BuildResult.Failed|r.BuildResult.PartiallySucceeded,void 0,void 0,void 0,void 0,1,r.QueryDeletedOption.ExcludeDeleted,r.BuildQueryOrder.FinishTimeDescending).then(function(e){var n=$("#query-info-container");n.empty();var i=e.map(function(t){return c(t)}),o={height:"100%",width:"100%",source:i,columns:[{text:"Time",width:200,index:"QueueTime"},{text:"Definition",width:200,index:"Definition"},{text:"Build",width:200,index:"BuildNumber"},{text:"Result",width:200,index:"Result"}]};return s.create(a.Grid,n,o),t.WidgetStatusHelper.Success()},function(e){return t.WidgetStatusHelper.Failure(e.message)})}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(){}return t}();e.Row=l,VSS.require("TFS/Dashboards/WidgetHelpers",function(t){t.IncludeWidgetStyles(),VSS.register("BrokenBuilds",function(){return{load:function(e){return n.TelemetryClient.getClient(i.settings).trackPageView("BrokenBuilds.Index"),$("h2.title").text(e.name),u(t,e),t.WidgetStatusHelper.Success()},reload:function(e){return $("h2.title").text(e.name),u(t,e),t.WidgetStatusHelper.Success()}}}),VSS.notifyLoadSucceeded()})}.apply(e,i))&&(t.exports=o)}])});